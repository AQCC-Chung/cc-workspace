<!DOCTYPE html>
<html>
<body>
  <button id="playBtn">Play Audio</button>
  <script>
    const base64Audio = `$(cat test_audio_b64.txt)`;
    
    function decodeBase64(base64) {
      const binaryString = atob(base64);
      const bytes = new Uint8Array(binaryString.length);
      for (let i = 0; i < binaryString.length; i++) {
        bytes[i] = binaryString.charCodeAt(i);
      }
      return bytes;
    }

    async function playRawPcm(data, sampleRate = 24000, numChannels = 1) {
      const audioCtx = new (window.AudioContext || window.webkitAudioContext)({ sampleRate });
      const dataInt16 = new Int16Array(data.buffer);
      const frameCount = dataInt16.length / numChannels;
      const audioBuffer = audioCtx.createBuffer(numChannels, frameCount, sampleRate);

      for (let channel = 0; channel < numChannels; channel++) {
        const channelData = audioBuffer.getChannelData(channel);
        for (let i = 0; i < frameCount; i++) {
          channelData[i] = dataInt16[i * numChannels + channel] / 32768.0;
        }
      }

      const source = audioCtx.createBufferSource();
      source.buffer = audioBuffer;
      source.connect(audioCtx.destination);
      source.start();
    }

    document.getElementById('playBtn').addEventListener('click', () => {
      const data = decodeBase64(base64Audio);
      playRawPcm(data);
    });
  </script>
</body>
</html>
